

希望达到的目的，所需要的工作量，指标衡量

1. 重构motion planner框架，期望重构后有比较清晰的结构及与master一致的体验
2. 障碍物筛选引入新策略来考虑，防止急刹车和不合理的避让
3. 探索横纵向迭代优化方案

#### 2020.10.09

Motion Planner要做的事情

1. 纵向规划起步慢

2. 障碍物未筛选掉被该被筛选掉的车辆

3. 接入AP MultiProposal

   

4. 障碍物筛选-结合RSS或者其他定责模型

5. 纵向规划的评估-不同输入的

6. 接入AP 多策略-

7. 重构motion planner框架

#### 2020.10.10

上午对了一下工作计划

some thoughts

梳理一下Tag生成思路，包括横向和纵向

1. 虚拟出一条纵向轨迹
2. 根据纵向轨迹接近程度来加入到横向ds图
3. 根据ds图搜索出一条横向轨迹
4. 根据横向轨迹接近程度来确定纵向障碍物
5. 进行纵向搜索，打上纵向tag，进行循环

计算完tag之后，计算障碍物边界，计算输入，得到输出

1. 纵向输入障碍物及边界
2. 横向输出障碍物及边界

#### 2020.10.12

上午解决高速前车纵向避让不足的问题

#### 2020.10.16

1. 讨论并完成了障碍物超越后车label的生成，现在在仿真
2. 高速前车纵向避让不足的问题
3. 阅读eudm



#### 2020.10.19

1. 合入6003和6808
2. 开会，与预测协调
3. 阅读eudm

#### 2020.10.20

1. 重构代码框架

#### 2020.10.21

1. 完成纵向规划的代码框架重构
2. 仿真及检查，基本完成代码重构，planning log有些问题

#### 2020.10.22

1. 完成planning log的修复
2. 应该ignore factor， supper有问题
3. 终点停车有点问题以及无解超出约束
4. 读eudm(DCP, CFB)，讨论eudm

#### 2020.10.23

1. 仿真测试（红绿灯场景识别不对，纵向fallback直接进入匀jerk刹车）
2. 修复跟踪多辆车选择leader不对的bugDONE
3. 纵向fallback直接进入匀jerk刹车DONE
4. 红绿灯刹车不一致NOT YET(找到原因了，vref导致的)
5. DP没管红绿灯，可能是bug(不是bug)



#### 2020.10.26

1. 提交测试6984， rebase master
2. 上周合入了这两个修改，完成了纵向优化的重构仿真
3. 发现对于横穿避让不足

#### 2020.10.27

1. 对横穿不足发现master有一个bug(7022)，红绿灯6094已修复
2. 发现紧急场景s upper未加上以及前半段减速慢
3. 整理master急刹车

#### 2020.10.28

1. 定位7041问题

#### 2020.10.29

1. 确认7041bug，是否可以修复
2. 确认7022bug，路测
3. 6554继续测试，仿真比较前半段减速慢的问题， 对了issue
4. 修复了前段刹车轻，后端刹车重问题

#### 2020.10.30

1. 开会讨论路障的问题
2. 下午讨论10月份的复盘

#### 2020.11.02

1. 合入7041和7022
2. 上周修复了两个bug7041和7022，一个是超车纵向不加速的，另一个是在keep onsite状态下不避让前方行人导致的接管，然后纵向优化重构的仿真遇到的问题也都基本修复了，测试了大概两圈o2l+和lgA，数据还没看完。横向优化可视化的代码应该这两天能完成，有一些delay主要是在解决路测的一些问题。

#### 2020.11.03

1. 对于6554
   1. 加上jerk bound
   2. 减少加速时的vref，设置加速的加速度
   3. 增加不确定性的考虑
   4. 修复fallback中未加s upper的bug
   5. 进行仿真和过ci，晚上提个路测
   6. 比较近的车自车不起步？35m红绿灯
2. 前段刹车轻，后端刹车重的问题
   1. 仿真看问题
   2. 两个思路，1 在路口里面增加跟车距离 2.增加限速

#### 2020.11.04

1. 对于7011，增加绕行限速，提交ci
2. 看6554的数据，没啥问题
   1. 超车，无法超车
3. 发邮件进行feature合入测试

#### 2020.11.05

1. 横向结果可视化
2. 搞定7086可视化
3. 分析急刹数据

#### 2020.11.06

1. 7011优化s cost
2. 两个问题：
   1. s lower和s meet



#### 2020.11.09

1. 上午看6554的数据
2. 分析了急刹车的case
3. 合入7011和6554
4. 合入7086
5. 发现7011起步慢的问题？解决。
6. 修复7011问题

#### 2020.11.10

1. 合入7011和6554
2. 看6575
3. 6554两个问题
   1. 过完减速
   2. keep onsite不减速(修复)
   3. 修复红绿灯前无解问题
   4. 修复红绿灯前选leader错误
4. 6575
   1. 两个问题，后车tag错误
   2. 后车避让不足问题定位
5. 修改pp debug
6. 面试，定位了一个bug 7228

#### 2020.11.11

1. 6575横向求解问题，wrong tag确认
2. 实习生工作安排
   1. 路测case分析和issue建立
   2. motion planner评估
3. 纵向tag一致性优化
   1. 输入不考虑预测，是直接从fusion拿结果？
   2. 可能需要加一点就是有了意图之后如何考虑自车来生成一条轨迹
   3. 每个粒子
4. 急刹case确认
5. 合入6554， rebase7200， 6757，7011， 6086

#### 2020.11.12

1. 合入7220和7086
2. 修复7228
3. CI太难了
4. 修复7250

#### 2020.11.13

1. 合入7086
2. 修复7250
3. 纵向重构复盘
   1. 在重构的时候尽量不修改原有的参数，把重构跟调参分开
   2. 在上线前对比仿真测试结果，比较有用
   3. 有一些bug也尽量少在重构修复
   4. 尽量不要拖太久
   5. 代码每一部分都要有注释
   6. 少用magic number
4. 为什么跑0场景不会掉头，加一个掉头的case
5. 测试7250



#### 2020.11.17

1. 测试7011，增加7011硬约束和软约束
2. 测试若干个7011case
3. 讨论dmpp
4. 发现surpass会无解
5. 修复6575，提交了6575测试
6. 分数据

#### 2020.11.18

1. 测试7011和6575
2. 面试简历
3. 看横向的代码
4. 看牛客网，e成和实习生的简历

#### 2020.11.19

1. 定位7327问题
2. 解决7327

#### 2020.11.20

1. 跟实习生交流一下
2. 合入7011,6575
3. 修复7327 fallback修复，修改freespace导致的横向无解

### sumary

1. 合入7011和6575
2. 修复uturn时急刹车问题(一定概率)
3. 7228和7327



#### 2020.11.23

1. 7379过ci
2. 路测急刹数据分析
3. 考虑一下对不同障碍物设置bound和ref

#### 2020.11.24

1. 写完7377代码，测试uturn，一些路口
2. 检查freespace(修复uturn和障碍物)，修复参考

#### 2020.11.25

1. 面试liwei
   1. 你觉得eudm planner跟dp搜索或者其他的方法比有什么优势呀
   2. 你之后在pp内部有思考过想做那部分内容吗？
   3. 现在有哪些offer呀，意向如何
2. 看接管问题
3. 完成7377 bound和ref的设置
4. 急刹车分析

#### 2020.11.26

1. 修改log显示
2. 测试7379
3. 仿真nudge

#### 2020.11.27

1. 阅读代码



#### 2020.11.30

1. 上周主要在做7377，修复了之前不考虑虚拟障碍物和freespace的问题，将freespace，虚拟障碍物，unknown目标以及行人和vehicle这五类障碍物统一考虑边界和参考。主要能够解决几个问题，两点优化，解决四个问题
   1. 第一个是uturn处出现的无解问题，由于考虑了freespace，能够提前避让，不会进入无解的状态。
   2. 近距离绕行时一些路障时横向会求解失败，主要是因为在bound之前提前考虑了障碍物的reference
   3. 同时由于提前考虑reference，横向优化绕行时也会避让更多
   4. 7335主要是指在一侧有车辆，另一侧是路边缘时，考虑了虚拟障碍物回避让的更加合理
2. 修复7471，看一下横向边界
3. 修复7462，横向无解时轨迹垂直车身

#### 2020.12.01

1. 修复7471，合入master
2. 修复7462，横向无解时轨迹乱飘
3. 上午阅读横向边界代码
4. 修复vscode打开jupyter问题
5. 横向通过性

#### 2020.12.02

1. 横向通过性
2. 检查横向边界reset
3. 急刹数据分析

#### 2020.12.03

1. 分析急刹数据
2. 编写7498

#### 2020.12.04

1. 对unknown目标仿真，测试7498



### 2020.11月份总结

1. 纵向
   1. 6554重构代码测试和合入bug修复
   2. 7011优化并道时前段刹车轻后端刹车重
2. 横向
   1. 7086可视化横向优化过程
   2. 6575修复变道横向无解
   3. 7377对不同障碍物设置不同边界和参考
3. 接下来要做
   1. 参考线平滑
   
      

#### 2020.12.07

1. 合入几个topic7462，7498，7388
2. 发现边界问题，开会
3. 思考freespace的参考线优化

#### 2020.12.08

1. 合入7572
2. 面试全职

#### 2020.12.09

1. 测试7598
2. 调研阿波罗的参考线平滑
3. review 红绿灯

#### 2020.12.10

1. 7598
2. reference平滑方案
3. reference unittest
4. reference 可视化

#### 2020.12.11

1. 对急刹车case和合入7598
2. unittest和可视化



#### 2020.12.14

1. 开会
2. 完成了部分参考线规划的代码
3. 讨论红绿灯

#### 2020.12.16

1. 参考线平滑
   1. 搭建框架，mpc结构

#### 2020.12.17-2020.12.18

1. Lesson: 多思考别人的话
2. Lesson: sqrt开方
3. 完成参考线优化pipline，包括优化条件的设置，输入可视化，以及输出
4. 利用现有的mpc横向优化进行参考线平滑，符合预期



#### 2020.12.21

1. 发现帧与帧之间的Freespace边界不相同
2. 7707 last r解决

#### 2020.12.22

1. 解决7707（两个好处轨迹不会异常，变道更快，风险项不舒适）
2. 完成replan和mpc新的求解器

#### 2020.12.23

1. 整理参考线优化
2. 编写参考线优化代码
3. 基本完成replan和一些case

#### 2020.12.24

1. 曲率学习

#### 2020.12.25

1. 增加平移参考线
2. 发现150m后优化边界不对



下面由我来跟大家分享下我Q4季度所做的一些工作，

我在Q4呢主要做的是Motion pLANNER相关的内容，包括纵向规划和横向规矩。对于纵向规划来说呢，主要是解决了由于纵向规划线型不合理以及被他车车辆cut in导致的接管和急刹车问题。同时也完成了纵向优化代码重构的工作，虽然中间遇到了一些挫折，但最后也是比较顺利的完成，使纵向这一部分代码有一个崭新的面貌。对于多轨迹来说，这部分是没有完成的，是需要上游模块进行主导。

对于横向规划来说呢，这部分内容也是十月底的调整，接手了科哥负责的横向优化，主要解决了两块内容吧，一部分是基本上完全解决了在十月底占接管和急刹比较多的横向求解失败问题，另外也做了一些提高横向通过性的工作，使得现在的横向能够比较好的在不同障碍物之间进行绕行。同时科哥也在这块提供了比较多的帮助，有20-30%的工作量贡献；

自我提升和团队建设方面：自己独立负责Motion Planner，有比较大的成长，planner这部分也有比较大的提高；专利这部分是没有完成的，主要也是因为人力调整导致的精力不足；总体的OKR是这样，接下来进行简单介绍下：

对于O1KR1和KR2呢主要是解决路测中纵向优化相关的一些问题，包括解一些bug以及对纵向规划线型及问题定义进行更加细致的设计；这里举个例子：比如在路口我们决定避让其他车辆的时候会出现前段刹车轻后端急刹车的问题，这里我增加了优化时的松弛因子以及绕行的限速，使优化的线型从图一变成了图二；

然后可以看一个视频，这是一个路口里面避让右拐车辆的视频，我们提前决定刹车之后，就会以一个较为合适的减速度进行减速，而不至于到后面进行急刹车。通过KR1和KR2呢，基本上解决了纵向路测相关的问题，近半个月没有出现相关的急刹和接管；

对于O1的KR3呢，主要是完成了纵向代码的重构，这里不具体展开了；只讲一下highlight和lowlight，。。。。这是纵向的内容

对于O2主要是做了三部份工作，一部分是着重花费时间解决了十月急啥占比30%左右的横向无解问题，基本上清零了除了自车横向确实无法通过的横向求解失败问题；对MPHB有比较大的提高；第二部分工作呢主要是解决横向绕行变道场景下的一些关键问题，包括不同障碍物绕行规则：。。。。

第三部分呢是12月中旬开始做的一项工作，主要是为了解决一些不友好的参考线导致的横向无解，参考线在一些拼接的地方特别是在提速之后会有横向晃动问题；现在的结果呢是能够克服原始dm给的参考线距离freespace过近的问题，还没有完全验证好。。。。

总结一下：。。。。也减少了一些工作量；

总结一下Q4的关键词呢就是迭代稳定，不论是PP还是Motion planner都是进入了一个稳定状态；对于下一个阶段的关键词是探索：因为现在遇到的一些问题包括与他车交互的以及特定场景下的难题都需要比较新颖的方案来解决，所以下一阶段希望能够做出一些更加有创新性的工作；



对于发哥本身的工作包括急刹报警以及纵向tag一致性都是非常solid而且比较有创新的，另外在跟发哥讨论方案设计的过程中呢，经常会有一些奇思妙想(口头禅就是我有个大胆的想法)，而且这些想法仔细想来又比较有道理，还是让人受益匪浅的。



#### 2020.12.18

1. 上午开了周会
2. 下午组会完成专利

#### 2020.12.29

1. 完成专利
2. 修复一个bug(远距离的freespace求出来的结果不对)

#### 2020.12.30

1. 修复bug
2. 增加keep功能